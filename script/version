#!/bin/bash -e
#
# script/version
# mas
#
# Displays the current marketing version of mas.
#

# This no longer works with MARKETING_VERSION build setting in Info.plist
# agvtool what-marketing-version -terse1

if git describe >/dev/null 2>&1; then
  MAS_VERSION=$(git describe --abbrev=0 --tags 2>/dev/null || true)
else
  MAS_VERSION=1.0.0
fi
MAS_VERSION=${MAS_VERSION#v}
echo "${MAS_VERSION}"

SCRIPT_PATH=$(dirname "$(which "$0")")

cat <<EOF >"${SCRIPT_PATH}/../Sources/MasKit/Package.swift"
// Generated by: script/version
enum Package {
    static let version = "${MAS_VERSION}"
}
EOF
